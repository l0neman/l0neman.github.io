<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Xposed 框架的使用 - l0neman 的博客</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="l0neman 的博客"><meta name="msapplication-TileImage" content="/img/avatar.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="l0neman 的博客"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Xposed 简介Xposed 框架是 Android 平台上一个非常著名且强大的开源框架，使用它能够对系统进程内运行的方法进行 hook，所以可以用它来做一些系统层面的工作，它拥有无限可能的灵活性，目前市面上基于 Xposed 框架下开发 Xposed 子模块已经数不胜数了。 原理简析Android 系统运行的核心和起点是 Zygote 进程，所有应用都是从它 fork 子进程产生的，当系统开始"><meta property="og:type" content="blog"><meta property="og:title" content="Xposed 框架的使用"><meta property="og:url" content="https://l0neman.github.io/2020/06/03/xposed-%E6%A1%86%E6%9E%B6%E7%9A%84%E4%BD%BF%E7%94%A8/"><meta property="og:site_name" content="l0neman 的博客"><meta property="og:description" content="Xposed 简介Xposed 框架是 Android 平台上一个非常著名且强大的开源框架，使用它能够对系统进程内运行的方法进行 hook，所以可以用它来做一些系统层面的工作，它拥有无限可能的灵活性，目前市面上基于 Xposed 框架下开发 Xposed 子模块已经数不胜数了。 原理简析Android 系统运行的核心和起点是 Zygote 进程，所有应用都是从它 fork 子进程产生的，当系统开始"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://l0neman.github.io/img/og_image.png"><meta property="article:published_time" content="2020-06-03T13:49:30.000Z"><meta property="article:modified_time" content="2020-06-03T13:49:30.000Z"><meta property="article:author" content="l0neman"><meta property="article:tag" content="Android"><meta property="article:tag" content="Xposed"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://l0neman.github.io/2020/06/03/xposed-%E6%A1%86%E6%9E%B6%E7%9A%84%E4%BD%BF%E7%94%A8/"},"headline":"Xposed 框架的使用","image":["https://l0neman.github.io/img/og_image.png"],"datePublished":"2020-06-03T13:49:30.000Z","dateModified":"2020-06-03T13:49:30.000Z","author":{"@type":"Person","name":"l0neman"},"publisher":{"@type":"Organization","name":"l0neman 的博客","logo":{"@type":"ImageObject","url":"https://l0neman.github.io/img/logo.png"}},"description":"Xposed 简介Xposed 框架是 Android 平台上一个非常著名且强大的开源框架，使用它能够对系统进程内运行的方法进行 hook，所以可以用它来做一些系统层面的工作，它拥有无限可能的灵活性，目前市面上基于 Xposed 框架下开发 Xposed 子模块已经数不胜数了。 原理简析Android 系统运行的核心和起点是 Zygote 进程，所有应用都是从它 fork 子进程产生的，当系统开始"}</script><link rel="canonical" href="https://l0neman.github.io/2020/06/03/xposed-%E6%A1%86%E6%9E%B6%E7%9A%84%E4%BD%BF%E7%94%A8/"><link rel="icon" href="/img/avatar.png"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.15.2/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><script>var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "//hm.baidu.com/hm.js?1727d76e0a823184efc8776f32a916a9";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();</script><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.4.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.png" alt="l0neman 的博客" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">主页</a><a class="navbar-item" href="/archives">归档</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" href="/about">关于</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/l0neman"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-three-quarters"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2020-06-03T13:49:30.000Z" title="2020/6/3 下午9:49:30">2020-06-03</time>发表</span><span class="level-item"><time dateTime="2020-06-03T13:49:30.000Z" title="2020/6/3 下午9:49:30">2020-06-03</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/android-%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/">Android 逆向工程</a></span><span class="level-item">16 分钟读完 (大约2380个字)</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>次访问</span></div></div><h1 class="title is-3 is-size-4-mobile">Xposed 框架的使用</h1><div class="content"><h2 id="Xposed-简介"><a href="#Xposed-简介" class="headerlink" title="Xposed 简介"></a>Xposed 简介</h2><p>Xposed 框架是 Android 平台上一个非常著名且强大的开源框架，使用它能够对系统进程内运行的方法进行 hook，所以可以用它来做一些系统层面的工作，它拥有无限可能的灵活性，目前市面上基于 Xposed 框架下开发 Xposed 子模块已经数不胜数了。</p>
<h2 id="原理简析"><a href="#原理简析" class="headerlink" title="原理简析"></a>原理简析</h2><p>Android 系统运行的核心和起点是 Zygote 进程，所有应用都是从它 fork 子进程产生的，当系统开始运行时由 <code>init.rc</code> 脚本启动， 使用 <code>/system/bin/app_process</code> 程序完成启动，它加载所需的类并调用初始化方法。</p>
<p>Xposed 框架将在这个地方发挥作用，当 Xposed 框架被安装时，一个被扩展的 <code>app_process</code> 程序将被复制到 <code>/system/bin/</code> 中，这个扩展的 <code>app_process</code> 将向类的路径附加一个 <code>jar</code> 文件，并在某些位置调用其方法，可能是虚拟机创建之后，或者在 Zygote 进程的 main 方法之前。在这个方法里，我们可以在其上下文中做插桩。</p>
<span id="more"></span>


<h2 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h2><p>Xposed 框架会替换系统的关键文件，所以需要 root 权限，获取 root 权限之后，安装 Xposed 框架。</p>
<p>Xposed 下载地址: <a target="_blank" rel="noopener" href="http://repo.xposed.info/module/de.robv.android.xposed.installer">http://repo.xposed.info/module/de.robv.android.xposed.installer</a></p>
<p>安装 Xposed 框架的 APK 后，进入并点击 <code>INSTALL/UPDATE</code> 下面的版本号，即可开始安装。</p>
<p><strong>提示：安装可能会导致设备无限重启或变砖，所以一定要确认适合自己的设备后再安装。</strong></p>
<h2 id="模块开发"><a href="#模块开发" class="headerlink" title="模块开发"></a>模块开发</h2><p>Xposed 框架安装完毕后即可进行 Xposed 模块的开发，我们自定义的功能都是在 Xposed 模块中实现的。</p>
<p>它是一个普通的 APK，包含一些实现 Xposed 依赖库提供的特定接口的类，当它被安装到设备后，被 Xposed 框架调起发挥作用，下面开始进行 Xposed 模块的开发。</p>
<h3 id="项目依赖"><a href="#项目依赖" class="headerlink" title="项目依赖"></a>项目依赖</h3><p>首先添加项目依赖。</p>
<ol>
<li>确认根 Project 或 Module 添加了 jcenter 的仓库渠道。</li>
</ol>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">repositories &#123;</span><br><span class="line">    jcenter();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>添加 Xposed 库的编译支持。</li>
</ol>
<p>Android Studio 3.0+ 的版本</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    compileOnly <span class="string">&#x27;de.robv.android.xposed:api:82&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>低于 3.0 的版本</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    provided <span class="string">&#x27;de.robv.android.xposed:api:82&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>注意：这里的选项是指定只参与编译，不需要真正的导入它的类</strong>，因为系统的 Xposed 框架内已经提供了这些类，所以不要用 <code>implementation(Studio 3.0+)</code> 和 <code>complie(lower than 3.0)</code>。</p>
<h3 id="方法钩子"><a href="#方法钩子" class="headerlink" title="方法钩子"></a>方法钩子</h3><p>方法钩子是 Xposed 的核心功能，一般通过对 APK 反编译后进行修改的方式，可以在任何位置插入和更改代码，但是必须重新编译打包整个包。使用 Xposed 可以放置方法钩子，不能修改方法代码，不过可以在方法调用的前后插入代码。</p>
<p><code>XposedBridge</code> 中有一个私有的 <code>hookMethod</code> 本地方法，它在扩展后的 <code>app_process</code> 中实现，它可以将方法更改为本地方法，并链接到自己的泛型本地方法，每次调用钩子方法时，都将调用泛型方法，但是调用方无需知晓，在这个方法中，会调用 <code>XposedBridge</code> 的 <code>handleHookedMethod</code> 方法，<code>handleHookedMethod</code> 则会调用注册的回调方法。这里可以更改调用的参数、更改实例或静态变量、调用其他方法或对结果执行某些操作…或者跳过任何内容。 </p>
<ul>
<li>下面在 Android Studio 中创建一个 Module，在 <code>AndroidManifet.xml</code> 的 <code>application</code> 标签中添加 3 个 <code>meta-data</code> 标签。</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">application</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:icon</span>=<span class="string">&quot;@drawable/ic_launcher&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">android:label</span>=<span class="string">&quot;@string/app_name&quot;</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta-data</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:name</span>=<span class="string">&quot;xposedmodule&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:value</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta-data</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:name</span>=<span class="string">&quot;xposeddescription&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:value</span>=<span class="string">&quot;Easy example which makes the status bar clock red and adds a smiley&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta-data</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:name</span>=<span class="string">&quot;xposedminversion&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">android:value</span>=<span class="string">&quot;82&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">application</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol>
<li><code>xposedmodule</code> 是固定的配置，说明自己是一个 Xposed 模块。</li>
<li><code>xposeddescription</code> 是 Xposed 模块的简要描述，在 Xposed 框架应用中会展示出来。</li>
<li><code>xposedminversion</code> 是 Xposed 模块的 API 版本，通常情况下，和使用的 Xposed API 版本应该一致。</li>
</ol>
<ul>
<li>实现 <code>IXposedHookLoadPackage</code> 接口，这个是放置方法钩子的入口点，如果需要实现资源替换，需要实现另外的接口，当 Android 系统启动时，每一个应用加载启动时都会回调这个接口。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> io.l0neman.xposedproject;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyXposedStub</span> <span class="keyword">implements</span> <span class="title">IXposedHookLoadPackage</span> </span>&#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleLoadPackage</span><span class="params">(<span class="keyword">final</span> XC_LoadPackage.LoadPackageParam lpparam)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">    <span class="comment">/* 激活模块后，使用 Xposed 作为标签过滤即可看到每个加载的应用包名 */</span></span><br><span class="line">    XposedBridge.log(<span class="string">&quot;Loading app: &quot;</span> + lpparam.packageName);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>最后需要配置入口点，在 assets 目录下，建立一个 <code>xposed_init</code> 文件，它的每行都可以指定一个入口点的全类名。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">io.l0neman.xposedproject.MyXposedStub</span><br></pre></td></tr></table></figure>

<ul>
<li>现在安装 APK，然后打开 Xposed 框架，勾选这个模块，重启手机，就能看到日志。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Loading Xposed (for Zygote)...</span><br><span class="line">Loading modules from /data/app/io.l0neman.xposedproject-1.apk</span><br><span class="line">  Loading class io.l0neman.xposedproject</span><br><span class="line">Loaded app: com.android.systemui</span><br><span class="line">Loaded app: com.android.settings</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<ul>
<li>上面的基础工作做完了，现在就可以使用 XposedHelpers 的辅助方法来获取方法钩子了，下面对一个应用的 Application 类进行 hook。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyXposedClient</span> <span class="keyword">implements</span> <span class="title">IXposedHookLoadPackage</span> </span>&#123;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleLoadPackage</span><span class="params">(<span class="keyword">final</span> XC_LoadPackage.LoadPackageParam lpparam)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">    <span class="comment">/* 激活模块后，使用 Xposed 作为标签过滤即可看到每个加载的应用包名 */</span></span><br><span class="line">    XposedBridge.log(<span class="string">&quot;Loading app: &quot;</span> + lpparam.packageName);</span><br><span class="line">    <span class="keyword">if</span> (!lpparam.packageName.equales(<span class="string">&quot;com.android.systemui&quot;</span>)) &#123;</span><br><span class="line">       <span class="keyword">return</span>; <span class="comment">// 过滤目标包名</span></span><br><span class="line">    &#125;</span><br><span class="line">    XposedHelpers.findAndHookMethod(Application.class, <span class="string">&quot;attach&quot;</span>, Context.class,</span><br><span class="line">        <span class="keyword">new</span> XC_MethodHook() &#123;</span><br><span class="line">          <span class="meta">@Override</span></span><br><span class="line">          <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">beforeHookedMethod</span><span class="params">(MethodHookParam param)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">            <span class="comment">/* 可以更改 hook 方法的行为 */</span></span><br><span class="line">            <span class="comment">// param.setResult(null);</span></span><br><span class="line">            <span class="comment">// param.setThrowable(new Throwable());</span></span><br><span class="line">          &#125;</span><br><span class="line"></span><br><span class="line">          <span class="meta">@Override</span> <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">afterHookedMethod</span><span class="params">(MethodHookParam param)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">            <span class="comment">/* 获取到了 attach 方法的 context 参数 */</span></span><br><span class="line">            Context context = (Context) param.args[<span class="number">0</span>];</span><br><span class="line">          &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>除了以上的方法 hook 之外，也可对应用内的任意类型进行反射获取。</li>
</ul>
<h3 id="资源替换"><a href="#资源替换" class="headerlink" title="资源替换"></a>资源替换</h3><p>目前还没有使用资源替换的方法，后续会补充。</p>
<h2 id="避免重启的方法"><a href="#避免重启的方法" class="headerlink" title="避免重启的方法"></a>避免重启的方法</h2><p>每次更改 Xposed 模块的代码后，都需要从新启动 Android 设备，非常不利于调试，所以可以用一种方法只在第一次重启，以后都不用重启了。</p>
<p>原理就是，首先编写一个 XposedStub APK，然后在其中通过包名的形式寻找另一个实现 Xposed 逻辑的 APK，通过动态加载的方式加载调用 APK 中的类和方法，这时只需要每次更改实现逻辑的 APK 即可，无需重启刷新 XposedStub 这个 APK 里面的逻辑了，相当于搭了一个桥梁。</p>
<ul>
<li>首先实现一个实现逻辑的 APK，这里我需要一个能够 hook 类的方法，创建一个参数接收的类。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> io.l0neman.xposedproject;</span><br><span class="line"><span class="keyword">import</span> android.util.Log;</span><br><span class="line"><span class="keyword">import</span> de.robv.android.xposed.callbacks.XC_LoadPackage;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyXposedClient</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String TAG = <span class="string">&quot;MyXposedClient&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">handle</span><span class="params">(String seflApkPath, XC_LoadPackage.LoadPackageParam llparam)</span> </span>&#123;</span><br><span class="line">    Log.d(TAG, <span class="string">&quot;accept ok: &quot;</span> + llparam.packageName);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>然后编写 XposedStub APK，它将作为一个和 Xposed 框架通信的中间角色，接收 Xposed 框架的回调结果，并转交给目标 APK，下面是具体逻辑。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyXposedStub</span> <span class="keyword">implements</span> <span class="title">IXposedHookLoadPackage</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String TAG = <span class="string">&quot;MyXposedStub&quot;</span>;</span><br><span class="line">  <span class="comment">/* 目标 APK 包名 */</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String TARGET_PACKAGE_NAME = <span class="string">&quot;io.l0neman.xposedproject&quot;</span>;</span><br><span class="line">  <span class="comment">/* 目标 APK 内的类型 */</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String TARGET_INJECT_CLASS_NAME =</span><br><span class="line">      <span class="string">&quot;MyXposedClient&quot;</span>;</span><br><span class="line">  <span class="comment">/* 目标 APK 类的方法 */</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String TARGET_INJECT_METHOD = <span class="string">&quot;handleLoadPackage&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleLoadPackage</span><span class="params">(<span class="keyword">final</span> XC_LoadPackage.LoadPackageParam lpparam)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">    log(<span class="string">&quot;loading app: &quot;</span> + lpparam.packageName);</span><br><span class="line">    <span class="comment">/* hook Application 类，为了获取 Context 对象 */</span></span><br><span class="line">    XposedHelpers.findAndHookMethod(Application.class, <span class="string">&quot;attach&quot;</span>, Context.class,</span><br><span class="line">        <span class="keyword">new</span> XC_MethodHook() &#123;</span><br><span class="line">          <span class="meta">@Override</span> <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">afterHookedMethod</span><span class="params">(MethodHookParam param)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">            Context context = (Context) param.args[<span class="number">0</span>];</span><br><span class="line">            callTarget(context, lpparam);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* 使用 context ，寻找目标 APK 的安装包并调用目标方法 */</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">callTarget</span><span class="params">(Context context, XC_LoadPackage.LoadPackageParam lpparam)</span></span></span><br><span class="line"><span class="function">      <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    File apkPath = findApkPath(context, TARGET_PACKAGE_NAME);</span><br><span class="line">    <span class="keyword">if</span> (apkPath == <span class="keyword">null</span>) &#123; <span class="keyword">return</span>; &#125;</span><br><span class="line"></span><br><span class="line">    log(<span class="string">&quot;hit apk: &quot;</span> + apkPath);</span><br><span class="line">    PathClassLoader pathClassLoader = <span class="keyword">new</span> PathClassLoader(</span><br><span class="line">        apkPath.getAbsolutePath(), ClassLoader.getSystemClassLoader()</span><br><span class="line">    );</span><br><span class="line">    <span class="comment">/* 反射获取目标值类并调用其方法 */</span></span><br><span class="line">    Class&lt;?&gt; targetClass = Class.forName(TARGET_INJECT_CLASS_NAME, <span class="keyword">true</span>, pathClassLoader);</span><br><span class="line">    Method handle = targetClass.getMethod(TARGET_INJECT_METHOD, String.class,</span><br><span class="line">        XC_LoadPackage.LoadPackageParam.class);</span><br><span class="line">    handle.invoke(<span class="keyword">null</span>, apkPath.getPath(), lpparam);</span><br><span class="line">    log(<span class="string">&quot;inject ok&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* 返回 APK 的安装包文件路径，每个 APK 安装后都会有，data/app/com.xxx.xxx/base_x.apk */</span></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> File <span class="title">findApkPath</span><span class="params">(Context context, String packaegName)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (context == <span class="keyword">null</span>) &#123; <span class="keyword">throw</span> <span class="keyword">new</span> AssertionError(<span class="string">&quot;context is null&quot;</span>); &#125;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      Context targetContext = context.createPackageContext(packaegName,</span><br><span class="line">          Context.CONTEXT_INCLUDE_CODE | Context.CONTEXT_IGNORE_SECURITY</span><br><span class="line">      );</span><br><span class="line">      String apkPath = targetContext.getPackageCodePath();</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> File(apkPath);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (PackageManager.NameNotFoundException ignore) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">log</span><span class="params">(String log)</span> </span>&#123; Log.d(TAG, log); &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="提示"><a href="#提示" class="headerlink" title="提示"></a>提示</h2><p>编写 Xposed 模块时需要清楚的知道自己的代码处于什么环境，当 <code>handleLoadPackage</code> 被回调时，说明一个新的代码包（常见为一个新的应用）被加载起来了，此时下面的代码将运行在目标应用的进程中，当模块具有 UI 界面时，模块的代码将分别运行在本身的应用进程和注入的目标应用进程中，如果需要进行设配置，可能需要进行进程间通信。</p>
<p>由于一些原因，Xposed 框架的作者不再提供 Android 9 系统之上的版本，如果需要在 Android 9 平台或以上版本使用 Xposed，推荐使用基于 Magisk（面具框架）的 EdXposed 替代，目前它的最新版本具有即时更新模块的功能，不用再重启设备了。</p>
<p>Magisk 地址：<a target="_blank" rel="noopener" href="https://github.com/topjohnwu/Magisk">https://github.com/topjohnwu/Magisk</a></p>
<p>Edxposed 地址：<a target="_blank" rel="noopener" href="https://github.com/ElderDrivers/EdXposed">https://github.com/ElderDrivers/EdXposed</a></p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><p><a target="_blank" rel="noopener" href="https://github.com/rovo89/XposedBridge/wiki">https://github.com/rovo89/XposedBridge/wiki</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://api.xposed.info/reference/packages.html">https://api.xposed.info/reference/packages.html</a></p>
</li>
</ul>
</div><div class="article-licensing box"><div class="licensing-title"><p>Xposed 框架的使用</p><p><a href="https://l0neman.github.io/2020/06/03/xposed-框架的使用/">https://l0neman.github.io/2020/06/03/xposed-框架的使用/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>l0neman</p></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2020-06-03</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2020-06-03</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/android/">Android</a><a class="link-muted mr-2" rel="tag" href="/tags/xposed/">Xposed</a></div><div class="addthis_inline_share_toolbox"></div><script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5f0f12c19a2af379" defer></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">喜欢这篇文章？打赏一下作者吧</h3><div class="buttons is-centered"><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>支付宝</span><span class="qrcode"><img src="/img/qrcode/alipay.jpg" alt="支付宝"></span></a><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>微信</span><span class="qrcode"><img src="/img/qrcode/wxpay.jpg" alt="微信"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2020/06/05/git-%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">Git 常用命令</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2020/06/03/8086-%E8%B4%AA%E5%90%83%E8%9B%87/"><span class="level-item">8086 贪吃蛇</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">评论</h3><script src="https://utteranc.es/client.js" repo="l0neman/l0neman.github.io" issue-term="pathname" label="comment" theme="github-light" crossorigin="anonymous" async></script></div></div></div><!--!--><div class="column column-right  order-3 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="level is-mobile" href="#Xposed-简介"><span class="level-left"><span class="level-item">1</span><span class="level-item">Xposed 简介</span></span></a></li><li><a class="level is-mobile" href="#原理简析"><span class="level-left"><span class="level-item">2</span><span class="level-item">原理简析</span></span></a></li><li><a class="level is-mobile" href="#环境配置"><span class="level-left"><span class="level-item">3</span><span class="level-item">环境配置</span></span></a></li><li><a class="level is-mobile" href="#模块开发"><span class="level-left"><span class="level-item">4</span><span class="level-item">模块开发</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#项目依赖"><span class="level-left"><span class="level-item">4.1</span><span class="level-item">项目依赖</span></span></a></li><li><a class="level is-mobile" href="#方法钩子"><span class="level-left"><span class="level-item">4.2</span><span class="level-item">方法钩子</span></span></a></li><li><a class="level is-mobile" href="#资源替换"><span class="level-left"><span class="level-item">4.3</span><span class="level-item">资源替换</span></span></a></li></ul></li><li><a class="level is-mobile" href="#避免重启的方法"><span class="level-left"><span class="level-item">5</span><span class="level-item">避免重启的方法</span></span></a></li><li><a class="level is-mobile" href="#提示"><span class="level-left"><span class="level-item">6</span><span class="level-item">提示</span></span></a></li><li><a class="level is-mobile" href="#参考"><span class="level-left"><span class="level-item">7</span><span class="level-item">参考</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/android-%E5%AE%9E%E7%94%A8%E5%B7%A5%E5%85%B7/"><span class="level-start"><span class="level-item">Android 实用工具</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/android-%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91/"><span class="level-start"><span class="level-item">Android 应用开发</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/categories/android-%E7%B3%BB%E7%BB%9F%E5%8E%9F%E7%90%86/"><span class="level-start"><span class="level-item">Android 系统原理</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/android-%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/"><span class="level-start"><span class="level-item">Android 逆向工程</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%8F%82%E8%80%83%E6%96%87%E6%A1%A3/"><span class="level-start"><span class="level-item">参考文档</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%AE%9E%E7%94%A8%E5%B7%A5%E5%85%B7/"><span class="level-start"><span class="level-item">实用工具</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/"><span class="level-start"><span class="level-item">编程基础</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-11-14T16:18:50.000Z">2021-11-15</time></p><p class="title"><a href="/2021/11/15/staruml-%E7%A0%B4%E8%A7%A3%E6%96%B9%E6%B3%95/">StarUML 破解方法</a></p><p class="categories"><a href="/categories/%E5%AE%9E%E7%94%A8%E5%B7%A5%E5%85%B7/">实用工具</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-11-14T15:59:06.000Z">2021-11-14</time></p><p class="title"><a href="/2021/11/14/android-filter-%E5%88%86%E6%9E%90/">Android Filter 分析</a></p><p class="categories"><a href="/categories/android-%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91/">Android 应用开发</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-06-29T16:45:50.000Z">2021-06-30</time></p><p class="title"><a href="/2021/06/30/%E6%94%AF%E6%8C%81%E8%A7%A6%E6%91%B8%E6%8B%96%E5%8A%A8%E7%9A%84-touchdelegate/">支持触摸拖动的 TouchDelegate</a></p><p class="categories"><a href="/categories/android-%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91/">Android 应用开发</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-04-21T15:08:15.000Z">2021-04-21</time></p><p class="title"><a href="/2021/04/21/gdb-arm-%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/">GDB ARM 交叉编译环境搭建</a></p><p class="categories"><a href="/categories/android-%E5%AE%9E%E7%94%A8%E5%B7%A5%E5%85%B7/">Android 实用工具</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-04-21T15:04:39.000Z">2021-04-21</time></p><p class="title"><a href="/2021/04/21/dropbear-android-%E5%AE%89%E8%A3%85%E6%AD%A5%E9%AA%A4/">Dropbear Android 安装步骤</a></p><p class="categories"><a href="/categories/android-%E5%AE%9E%E7%94%A8%E5%B7%A5%E5%85%B7/">Android 实用工具</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2021/11/"><span class="level-start"><span class="level-item">十一月 2021</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/06/"><span class="level-start"><span class="level-item">六月 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/04/"><span class="level-start"><span class="level-item">四月 2021</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/01/"><span class="level-start"><span class="level-item">一月 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/11/"><span class="level-start"><span class="level-item">十一月 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/10/"><span class="level-start"><span class="level-item">十月 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/09/"><span class="level-start"><span class="level-item">九月 2020</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/08/"><span class="level-start"><span class="level-item">八月 2020</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/07/"><span class="level-start"><span class="level-item">七月 2020</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/06/"><span class="level-start"><span class="level-item">六月 2020</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/05/"><span class="level-start"><span class="level-item">五月 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/04/"><span class="level-start"><span class="level-item">四月 2019</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/02/"><span class="level-start"><span class="level-item">二月 2019</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/arm/"><span class="tag">ARM</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/avd/"><span class="tag">AVD</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/activity/"><span class="tag">Activity</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/android/"><span class="tag">Android</span><span class="tag">24</span></a></div><div class="control"><a class="tags has-addons" href="/tags/assembly/"><span class="tag">Assembly</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/binder/"><span class="tag">Binder</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/classloader/"><span class="tag">ClassLoader</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/computer/"><span class="tag">Computer</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/dex/"><span class="tag">Dex</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/elf/"><span class="tag">ELF</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/emulator/"><span class="tag">Emulator</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/git/"><span class="tag">Git</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/jni/"><span class="tag">JNI</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/java/"><span class="tag">Java</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/log/"><span class="tag">Log</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/make/"><span class="tag">Make</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/makefile/"><span class="tag">Makefile</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/markdown/"><span class="tag">MarkDown</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/metrial/"><span class="tag">Metrial</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ndk/"><span class="tag">NDK</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/regex/"><span class="tag">Regex</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/ssh/"><span class="tag">SSH</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/theme/"><span class="tag">Theme</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/touch/"><span class="tag">Touch</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/view/"><span class="tag">View</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/xposed/"><span class="tag">Xposed</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/zygote/"><span class="tag">Zygote</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/aapt/"><span class="tag">aapt</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/uml/"><span class="tag">uml</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%83%AD%E4%BF%AE%E5%A4%8D/"><span class="tag">热修复</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%83%AD%E6%9B%B4%E6%96%B0/"><span class="tag">热更新</span><span class="tag">1</span></a></div></div></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.png" alt="l0neman 的博客" height="28"></a><p class="is-size-7"><span>&copy; 2021 l0neman</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">共<span id="busuanzi_value_site_uv">0</span>个访客</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/l0neman"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>